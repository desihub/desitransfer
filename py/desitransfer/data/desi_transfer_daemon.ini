#
# Configuration for a specific source -> desitination directory.
#
[DESI_SPECTRO_DATA]
# Directory containing NIGHT/EXPOSURE data at KPNO.
source = /data/dts/exposures/raw
# Directory where data will be initially transferred.
staging = ${DESI_ROOT}/spectro/staging/raw
# Directory where data will be moved to after verification.
destination = ${DESI_SPECTRO_DATA}
# Directory where HPSS backups will be stored.
hpss = desi/spectro/data
# A valid exposure--that the pipeline should be run on--should contain these files.
# expected_files = desi-{exposure}.fits.fz,fibermap-{exposure}.fits,guider-{exposure}.fits.fz
expected_files = desi-{exposure}.fits.fz
# Checksum files have this format.
checksum_file = checksum-{night}-{exposure}.sha256sum

#
# Common configuration for all transfers.
#
[common]
# Use this directory for temporary files.
scratch = ${CSCRATCH}
# scratch = ${HOME}/tmp
# UTC time in hours to look for delayed files.
# Disable this with an invalid hour, e.g. 30.
catchup = 14
# UTC time in hours to trigger HPSS backups.
# Disable this with an invalid hour, e.g. 30.
backup = 20
# Sleep this many minutes before checking for new data.
sleep = 10

#
# Log file configuration.
#
[logging]
filename = ${DESI_ROOT}/spectro/staging/logs/desi_transfer_daemon.log
# Rotate log files when they reach this many bytes.
size = 100000000
# Save this many old log files.
backups = 100
# Send critical alerts to these email addresses.
# to = desi-data@desi.lbl.gov
to = baweaver@lbl.gov

#
# Configuration for generating pipeline commands.
#
[pipeline]
# This is the effective pipeline command on the remote host.
desi_night = ${HOME}/bin/wrap_desi_night.sh
# Path to ssh.
ssh = /bin/ssh
# Run pipeline commands on this remote host.
host = cori
# NERSC queue.
queue = realtime
# Nodes for the job.
nodes = 25
# Map 'done' files to these pipeline commands.
commands = science:redshifts
# Use this pipeline command for exposures that are not special (i.e. not 'last').
exposure = update
